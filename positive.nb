(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    135507,       3970]
NotebookOptionsPosition[    126237,       3686]
NotebookOutlinePosition[    126702,       3704]
CellTagsIndexPosition[    126659,       3701]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization group", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.480130853138694*^9, 3.480130863267518*^9}, {
  3.505125768862028*^9, 3.505125770700338*^9}}],

Cell[CellGroupData[{

Cell["Some common operations", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728013103617*^9, 3.496728030543284*^9}}],

Cell["Adjoint by unitary", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.48750505012385*^9, 3.487505057420328*^9}, {
  3.487565817857973*^9, 3.487565820736125*^9}, {3.496728050560895*^9, 
  3.496728054352267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ad", "[", 
    RowBox[{"u_", ",", "rho_"}], "]"}], " ", ":=", " ", 
   RowBox[{"u", ".", "rho", ".", 
    RowBox[{"u", "\[ConjugateTranspose]"}]}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.486787798374218*^9, 3.486787812341568*^9}, 
   3.486787848466005*^9, 3.487565833838318*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a_", "\[CircleTimes]", "b_"}], ":=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.492920481110301*^9, 3.492920542791096*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a_List", ",", "b_List"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[ConjugateTranspose]"}], ".", "b"}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5345017771960287`*^9, 3.534501798309486*^9}, {
  3.534570549169942*^9, 3.534570553365395*^9}, {3.6060376708165197`*^9, 
  3.606037672728025*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", ".", "b"}], "-", 
    RowBox[{"b", ".", "a"}]}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.5281814103544283`*^9, 3.528181498956253*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions making matrices, etc.", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.496727776527522*^9, 3.496727787647133*^9}}],

Cell["For compatibility reasons I left this function", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.496727806495353*^9, 3.496727826415164*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makematrix", "[", 
    RowBox[{"str_", ",", "size_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"ToExpression", "[", " ", 
      RowBox[{"str", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "size"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.479789133215009*^9, 3.479789165148757*^9}, {
  3.479789250237678*^9, 3.479789266324797*^9}, {3.487502719673249*^9, 
  3.487502721150584*^9}}],

Cell[TextData[{
 "These should replace ",
 StyleBox["makematrix", "Input"],
 ". First makes square matrix, second rectangular, third selfadjoint matrix."
}], "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.496727829934781*^9, 3.496727929055193*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mx", "[", 
    RowBox[{"str_", ",", "size_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"str", ",", "i", ",", "j"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "size"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.49639750771732*^9, 3.496397510451897*^9}, {
  3.496397542404948*^9, 3.496397614286846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mx", "[", 
    RowBox[{"str_", ",", "sizex_", ",", "sizey_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"str", ",", "i", ",", "j"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "sizex"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "sizey"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.496693547715412*^9, 3.496693556726426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"samx", "[", 
    RowBox[{"str_", ",", "size_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", "j"}], ",", 
       RowBox[{"Subscript", "[", 
        RowBox[{"str", ",", "i", ",", "j"}], "]"}], ",", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"Subscript", "[", 
         RowBox[{"str", ",", "j", ",", "i"}], "]"}], "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "size"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.496475148823058*^9, 3.496475203305516*^9}}],

Cell["\<\
Function returning unitary operators according to various parametrization.\
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.480131713908803*^9, 3.480131734161384*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ux", "[", "phi_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "phi", "]"}], ",", " ", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uy", "[", "phi_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "phi", "]"}], ",", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "phi", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uz", "[", "theta_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"\[ImaginaryI]", " ", "theta"}], "]"}], ",", " ", "0"}], "}"}],
     ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "theta"}], "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"un", "[", 
   RowBox[{"\[Xi]_", ",", " ", "\[Eta]_", ",", " ", "\[Zeta]_"}], "]"}], ":=",
   " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"\[ImaginaryI]", " ", "\[Xi]"}], "]"}], " ", 
       RowBox[{"Cos", "[", "\[Eta]", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"\[ImaginaryI]", " ", "\[Zeta]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Eta]", "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Zeta]"}], "]"}]}], 
       RowBox[{"Sin", "[", "\[Eta]", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Xi]"}], "]"}], " ", 
       RowBox[{"Cos", "[", "\[Eta]", "]"}]}]}], "}"}]}], "}"}]}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.47980047915937*^9, 3.479800513364245*^9}, {
  3.479801393421795*^9, 3.479801415223567*^9}, {3.479801453917833*^9, 
  3.479801488047023*^9}, {3.479801700086166*^9, 3.479801720514968*^9}, {
  3.479802020503713*^9, 3.479802136313278*^9}}],

Cell["Basis vectors, projectors, etc.", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728142943575*^9, 3.496728149711533*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", 
    RowBox[{"n_Integer", ",", " ", "dim_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ReplacePart", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{"n", "\[Rule]", "1"}]}], "]"}], " ", "&"}], " ", "@", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", "dim", "}"}]}], "]"}]}], "}"}], "\[Transpose]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"b", "\[Conjugate]"}]}], ",", " ", 
       RowBox[{"a", "\[Conjugate]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proj", "[", 
    RowBox[{"v_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"ArrayDepth", "[", "#", "]"}], "\[Equal]", "2"}], "&"}], 
      ")"}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Norm", "[", "v", "]"}], "^", "2"}], ")"}]}], 
    RowBox[{"v", ".", 
     RowBox[{"v", "\[ConjugateTranspose]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proj", "[", 
    RowBox[{"v_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"ArrayDepth", "[", "#", "]"}], "\[Equal]", "1"}], " ", "&"}], 
      ")"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"proj", "[", 
    RowBox[{
     RowBox[{"{", "v", "}"}], "\[Transpose]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proj", "[", 
    RowBox[{"v_", ",", "w_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Norm", "[", "v", "]"}], 
       RowBox[{"Norm", "[", "w", "]"}]}], ")"}]}], 
    RowBox[{"v", ".", 
     RowBox[{"w", "\[ConjugateTranspose]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tau", "[", "dim_", "]"}], ":=", " ", 
   RowBox[{"Sum", "[", " ", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"i", ",", "dim"}], "]"}], ",", 
       RowBox[{"e", "[", 
        RowBox[{"i", ",", "dim"}], "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 InitializationGroup->True,
 CellChangeTimes->{{3.487399678403819*^9, 3.487399756561209*^9}, {
  3.48739994835851*^9, 3.48739998347413*^9}, {3.487400223190869*^9, 
  3.487400224232774*^9}, {3.48740116275132*^9, 3.487401236735014*^9}, {
  3.488002961802021*^9, 3.488003016150759*^9}, {3.488003353310026*^9, 
  3.488003395246717*^9}, {3.499664775336329*^9, 3.499664779374474*^9}, {
  3.499665026940117*^9, 3.499665132578545*^9}, {3.499665472135857*^9, 
  3.499665479627942*^9}, {3.5213544554056797`*^9, 3.5213544886053457`*^9}, {
  3.606037508633279*^9, 3.606037512583929*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cVec", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", "v", "}"}], "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rVec", "[", "v_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"v", "\[Transpose]"}], ")"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.534739530023204*^9, 3.5347395573415747`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix type tests", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.496727939807749*^9, 3.496727944511471*^9}}],

Cell["\<\
Function for testing for bp semidefinteness, symmetry property (exact and \
numerical one), and testing for unitarity.\
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.480131608544734*^9, 3.480131644210165*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bpSemiDefiniteQ4", "[", "m_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f1", ",", "f2", ",", "g1", ",", "g2", ",", " ", "fg"}], "}"}], 
    ",", " \t", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fg", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f1", " ", "g1"}], ",", 
         RowBox[{"f1", " ", "g2"}], ",", 
         RowBox[{"f2", " ", "g1"}], ",", 
         RowBox[{"f2", " ", "g2"}]}], "}"}], "}"}]}], ";", 
     RowBox[{"Resolve", "[", " ", 
      RowBox[{
       RowBox[{"ForAll", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f1", ",", "f2", ",", "g1", ",", "g2"}], "}"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"GreaterEqual", "[", 
            RowBox[{"#", ",", "0"}], "]"}], "&"}], " ", "@@", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"fg", ".", "m", ".", 
            RowBox[{"fg", "\[HermitianConjugate]"}]}], "]"}]}]}], "]"}], ",", 
       " ", "Complexes"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpSemiDefiniteQ9", "[", "m_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "f1", ",", "f2", ",", " ", "f3", ",", "g1", ",", "g2", ",", " ", "g3", 
      ",", " ", "fg"}], "}"}], ",", " \t", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fg", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f1", " ", "g1"}], ",", 
         RowBox[{"f1", " ", "g2"}], ",", " ", 
         RowBox[{"f1", " ", "g3"}], ",", 
         RowBox[{"f2", " ", "g1"}], ",", 
         RowBox[{"f2", " ", "g2"}], ",", " ", 
         RowBox[{"f2", " ", "g3"}], ",", " ", 
         RowBox[{"f3", " ", "g1"}], ",", " ", 
         RowBox[{"f3", " ", "g2"}], ",", " ", 
         RowBox[{"f3", " ", "g3"}]}], "}"}], "}"}]}], ";", 
     RowBox[{"Resolve", "[", " ", 
      RowBox[{
       RowBox[{"ForAll", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "f1", ",", "f2", ",", " ", "f3", ",", "g1", ",", "g2", ",", " ", 
           "g3"}], "}"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"GreaterEqual", "[", 
            RowBox[{"#", ",", "0"}], "]"}], "&"}], " ", "@@", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"fg", ".", "m", ".", 
            RowBox[{"fg", "\[HermitianConjugate]"}]}], "]"}]}]}], "]"}], ",", 
       " ", "Complexes"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpFailQ4", "[", 
   RowBox[{"m_List", "?", "MatrixQ"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f1", ",", "f2", ",", "g1", ",", "g2", ",", " ", "fg"}], "}"}], 
    ",", " \t", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fg", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f1", " ", "g1"}], ",", 
         RowBox[{"f1", " ", "g2"}], ",", 
         RowBox[{"f2", " ", "g1"}], ",", 
         RowBox[{"f2", " ", "g2"}]}], "}"}], "}"}]}], ";", 
     RowBox[{"FindInstance", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Less", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], " ", "@@", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"fg", ".", "m", ".", 
          RowBox[{"fg", "\[HermitianConjugate]"}]}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"f1", ",", "f2", ",", "g1", ",", "g2"}], "}"}], ",", " ", 
       "Complexes"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symmetryQ", "[", 
   RowBox[{"m_List", "?", "MatrixQ"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"m", ".", "m"}], " ", "\[Equal]", " ", 
    RowBox[{"IdentityMatrix", "@", 
     RowBox[{"Length", "@", "m"}]}]}], " ", "&&", 
   RowBox[{
    RowBox[{"m", "\[HermitianConjugate]"}], "==", 
    "m"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symmetryNQ", "[", 
   RowBox[{"m_List", "?", "MatrixQ"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{"m", ".", "m"}], "//", "N"}], "]"}], " ", "\[Equal]", " ", 
    RowBox[{"IdentityMatrix", "@", 
     RowBox[{"Length", "@", "m"}]}]}], " ", "&&", 
   RowBox[{
    RowBox[{"m", "\[HermitianConjugate]"}], "==", 
    "m"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpecialUnitaryQ", "[", 
   RowBox[{"m_List", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Conjugate", "@", 
       RowBox[{"Transpose", "@", "m"}]}], ".", "m"}], "\[Equal]", 
     RowBox[{"IdentityMatrix", "@", 
      RowBox[{"Length", "@", "m"}]}]}], "&&", 
    RowBox[{
     RowBox[{"Det", "[", "m", "]"}], "\[Equal]", "1"}]}], ")"}]}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.479792233993592*^9, 3.479792239498401*^9}, {
   3.479792530076725*^9, 3.479792594452195*^9}, {3.479792662553691*^9, 
   3.479792746314106*^9}, {3.479792831343441*^9, 3.479792844458262*^9}, {
   3.479792879739988*^9, 3.479792902849099*^9}, {3.479792973434617*^9, 
   3.479792986831382*^9}, {3.479793025007628*^9, 3.47979302570462*^9}, {
   3.479793649122768*^9, 3.479793672968482*^9}, {3.479793706496216*^9, 
   3.479793852367961*^9}, {3.479794262074303*^9, 3.479794277554621*^9}, {
   3.479794520416303*^9, 3.479794520927183*^9}, {3.480054969970702*^9, 
   3.480054971661668*^9}, {3.480055427583019*^9, 3.480055457839448*^9}, {
   3.480055631654831*^9, 3.480055660241189*^9}, {3.480936397358732*^9, 
   3.480936398483991*^9}, {3.480936490129571*^9, 3.480936490524751*^9}, {
   3.480936616014413*^9, 3.480936621669041*^9}, {3.48093690118448*^9, 
   3.480936902402374*^9}, {3.480937223188002*^9, 3.480937289573215*^9}, {
   3.480937384894519*^9, 3.480937405177629*^9}, 3.480937473211939*^9, {
   3.48678556946799*^9, 3.486785569994629*^9}, {3.4867856111076*^9, 
   3.486785612869841*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"partialSymmetryQ", "[", "m_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"m", ".", "m", ".", "m", ".", "m"}], " ", "==", " ", 
   RowBox[{"m", ".", "m"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partialSymmetryRank", "[", "m_", "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"partialSymmetryQ", "[", "m", "]"}], ",", " ", 
    RowBox[{"Tr", "[", 
     RowBox[{"m", ".", "m"}], "]"}], ",", " ", "False"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partialSymmetryDiff", "[", "m_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", " ", 
      RowBox[{"(", 
       RowBox[{"Flatten", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", ".", "m", ".", "m", ".", "m"}], "-", 
          RowBox[{"m", ".", "m"}]}], ")"}]}], ")"}]}], ")"}]}], " ", "//", 
   "N"}]}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.488776758570725*^9, 3.488776800015847*^9}, {
  3.488776837129167*^9, 3.488776838425538*^9}, {3.488859453388452*^9, 
  3.488859469553381*^9}, {3.488859694798544*^9, 3.488859725497827*^9}, {
  3.489305710222205*^9, 3.489305740923096*^9}, {3.489305789339035*^9, 
  3.489305820942082*^9}, {3.48930588712965*^9, 3.489305888359538*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix manipulation", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728506688239*^9, 3.496728509392046*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"partialTranspose", "[", "m_", "]"}], ":=", " ", 
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"Map", "[", " ", 
    RowBox[{"Transpose", ",", " ", 
     RowBox[{"Partition", "[", 
      RowBox[{"m", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"Length", "[", "m", "]"}], "]"}], ",", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Length", "[", "m", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.488859207828608*^9, 3.488859213230232*^9}, {
  3.488859251926707*^9, 3.488859272385939*^9}, {3.489225530332145*^9, 
  3.48922555481549*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"partialTr", "[", "m_", "]"}], ":=", " ", 
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"Map", "[", " ", 
    RowBox[{"Tr", ",", " ", 
     RowBox[{"Partition", "[", 
      RowBox[{"m", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"Length", "[", "m", "]"}], "]"}], ",", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Length", "[", "m", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.496070891660429*^9, 3.496070897868661*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Calculation Choi matrix for various maps with various methods\
\>", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728066511587*^9, 3.496728078640839*^9}}],

Cell["Function that calculates Choi matrix by old method.", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.480131650005728*^9, 3.480131707764552*^9}, {
  3.496727992720478*^9, 3.496727998511035*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findRho", "[", " ", 
   RowBox[{"f_", ",", " ", "d_"}], " ", "]"}], ":=", 
  RowBox[{"Module", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", " ", "rho", ",", "vars", ",", " ", "sol"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", " ", "=", " ", 
      RowBox[{"makematrix", "[", 
       RowBox[{"\"\<a\>\"", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", " ", "=", " ", 
      RowBox[{"makematrix", "[", 
       RowBox[{"\"\<b\>\"", ",", " ", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rho", " ", "=", " ", 
      RowBox[{"makematrix", "[", 
       RowBox[{"\"\<rho\>\"", ",", " ", 
        RowBox[{"d", " ", "d"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", " ", "=", 
      RowBox[{"SolveAlways", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{"f", "[", "a", "]"}], ".", 
              RowBox[{"b", "\[Transpose]"}]}], "]"}], " ", "-", " ", 
            RowBox[{"Tr", "[", 
             RowBox[{"rho", ".", 
              RowBox[{"KroneckerProduct", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], ",", " ", "vars"}], 
          "]"}], " ", "==", " ", "0"}], ",", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "a", "]"}], ",", " ", 
          RowBox[{"Flatten", "[", "b", "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"rho", " ", "/.", " ", "sol"}], ",", " ", "1"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.481360875422303*^9, 3.481361046156831*^9}, {
  3.481361109146234*^9, 3.481361254091126*^9}, {3.481361532873713*^9, 
  3.481361779047953*^9}}],

Cell["\<\
This calculates density matrix for transposition in the base rotated by \
unitary transformation by angles \[Xi], \[Eta], \[Zeta] in 2D very special \
parametrization of unitary elements.\
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.486786246122566*^9, 3.486786348373525*^9}, {
  3.486786425426743*^9, 3.486786427011087*^9}, {3.486789858128035*^9, 
  3.486789866413774*^9}, {3.487505093975392*^9, 3.487505101044995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "[", 
    RowBox[{"\[Xi]_", ",", "\[Eta]_", ",", " ", "\[Zeta]_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"findRho", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ux", "[", "\[Xi]", "]"}], ".", 
          RowBox[{"uy", "[", "\[Eta]", "]"}], ".", 
          RowBox[{"uz", "[", "\[Zeta]", "]"}]}], ")"}], 
        "\[ConjugateTranspose]"}], ".", " ", 
       RowBox[{"Transpose", "[", "#", "]"}], ".", 
       RowBox[{"ux", "[", "\[Xi]", "]"}], ".", 
       RowBox[{"uy", "[", "\[Eta]", "]"}], ".", 
       RowBox[{"uz", "[", "\[Zeta]", "]"}]}], " ", "&"}], ",", " ", "2"}], 
    "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.486786355213807*^9, 3.48678642976211*^9}, {
   3.486788701332285*^9, 3.486788704718764*^9}, {3.486789786115699*^9, 
   3.486789854075029*^9}, {3.486789893041277*^9, 3.486789896709005*^9}, {
   3.486789999720381*^9, 3.486790033958821*^9}, {3.486794560269562*^9, 
   3.486794563799819*^9}, {3.487391910486877*^9, 3.48739191235135*^9}, 
   3.488697491650405*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findRhoChoi", "[", 
   RowBox[{"map_", ",", "dim_"}], "]"}], " ", ":=", "  ", 
  RowBox[{"Sum", "[", " ", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"proj", "[", 
       RowBox[{
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "dim"}], "]"}], ",", 
        RowBox[{"e", "[", 
         RowBox[{"j", ",", "dim"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"map", "[", 
       RowBox[{"proj", "[", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"i", ",", "dim"}], "]"}], ",", 
         RowBox[{"e", "[", 
          RowBox[{"j", ",", "dim"}], "]"}]}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.490337550877084*^9, 3.490337552677852*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Kroneckization, etc.", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.488509579198978*^9, 3.488509579870434*^9}, {
  3.496728168991786*^9, 3.4967281755674*^9}}],

Cell["Computing map on matrices as linear map on linear space.", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.487399658470807*^9, 3.487399673990617*^9}}],

Cell["\<\
It seems that the choice of apropriate kronecker product base is crucial. \
With following {1,2} transposition by Stormer lemma are the same as by \
kroneckization. Other maps differ.\
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.487505340142817*^9, 3.487505367952153*^9}, {
  3.487505436229902*^9, 3.487505475431792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kroneckize", "[", 
    RowBox[{"x_", ",", " ", "spec_", ",", " ", "dim_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"x", " ", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{
        RowBox[{"spec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "dim"}], "]"}], ",", " ", 
      RowBox[{"e", "[", 
       RowBox[{
        RowBox[{"spec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "dim"}], "]"}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.48740004201405*^9, 3.487400079216421*^9}, {
  3.487400133744238*^9, 3.487400164803144*^9}, {3.487400526819518*^9, 
  3.487400529126011*^9}, {3.487400980842855*^9, 3.487400982746503*^9}, {
  3.48748599297554*^9, 3.487485995213985*^9}, {3.48748603949293*^9, 
  3.487486041697663*^9}, {3.487504169532984*^9, 3.487504171557346*^9}, {
  3.487505705877234*^9, 3.487505708220795*^9}, {3.487505739178548*^9, 
  3.487505742199847*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"matrixToLinear", "[", "m_", "]"}], " ", ":=", " ", 
   RowBox[{"Plus", " ", "@@", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"MapIndexed", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"kroneckize", "[", 
          RowBox[{"#1", ",", " ", "#2", ",", " ", 
           RowBox[{"Length", "[", "m", "]"}]}], "]"}], " ", "&"}], ",", " ", 
        "m", ",", " ", 
        RowBox[{"{", "2", "}"}]}], "]"}], ",", " ", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linearToMatrix", "[", "l_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "l", "]"}], ",", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Length", "[", "l", "]"}], "]"}]}], "]"}], "\[Transpose]"}]}], 
  ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.487400005316766*^9, 3.487400040304882*^9}, {
  3.48740024911226*^9, 3.487400334942493*^9}, {3.487400386842203*^9, 
  3.487400426814793*^9}, {3.487400464395284*^9, 3.487400464554282*^9}, {
  3.487400508269381*^9, 3.487400514719373*^9}, {3.487505379056001*^9, 
  3.487505379411839*^9}, {3.487563490190768*^9, 3.487563491322952*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kProd", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{"matrixToLinear", "[", 
    RowBox[{
     RowBox[{"linearToMatrix", "[", "a", "]"}], ".", 
     RowBox[{"linearToMatrix", "[", "b", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kron", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"matrixToLinear", "[", "a", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dekron", "[", "a_", "]"}], ":=", 
   RowBox[{"linearToMatrix", "[", "a", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kTr", "[", "a_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tau", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"tau", " ", "=", " ", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"e", "[", 
             RowBox[{"i", ",", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"Length", "[", "a", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"e", "[", 
             RowBox[{"i", ",", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"Length", "[", "a", "]"}], "]"}]}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Length", "[", "a", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
      ";", " ", 
      RowBox[{"Plus", "@@", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"tau", "\[ConjugateTranspose]"}], ".", "a"}], "]"}]}]}]}], 
    "]"}]}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.487489335167101*^9, 3.487489359638201*^9}, {
  3.487489474252283*^9, 3.487489491944777*^9}, {3.4874895678899*^9, 
  3.487489859972332*^9}, {3.487489902596274*^9, 3.487489906567965*^9}}],

Cell["\<\
The following function calculate (anti)unitary matrix that is used in \
Kronecker product rule for kroneckization. It seems that it is also useful \
when going between Stormer lemma isomorphism and kroneckization.\
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.487564575897181*^9, 3.48756464092962*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uKroneckerProductRule", "[", "dim_", "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rho", ",", "a", ",", "b", ",", "map", ",", " ", "t1", ",", "t2", ",", 
       "rlist", ",", " ", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", " ", 
       RowBox[{"makematrix", "[", 
        RowBox[{"\"\<a\>\"", ",", " ", "dim"}], "]"}]}], ";", " ", 
      RowBox[{"b", "=", 
       RowBox[{"makematrix", "[", 
        RowBox[{"\"\<b\>\"", ",", "dim"}], "]"}]}], ";", " ", 
      RowBox[{"map", "=", 
       RowBox[{"makematrix", "[", 
        RowBox[{"\"\<map\>\"", ",", 
         RowBox[{"dim", "^", "2"}]}], "]"}]}], ";", " ", 
      RowBox[{"rho", " ", "=", " ", 
       RowBox[{"makematrix", "[", 
        RowBox[{"\"\<rho\>\"", ",", 
         RowBox[{"dim", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{
        RowBox[{"matrixToLinear", "[", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"a", ",", "b"}], "]"}], "]"}], "-", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"matrixToLinear", "[", "a", "]"}], ",", " ", 
          RowBox[{"matrixToLinear", "[", "b", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t2", " ", "=", 
       RowBox[{"Simplify", " ", "/@", " ", 
        RowBox[{"Abs", " ", "/@", " ", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "t1", "]"}], ",", " ", 
           RowBox[{
            RowBox[{"#", "=!=", " ", "0"}], "&"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rlist", " ", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"Reverse", "[", "#", "]"}]}], "}"}], " ", "&"}], " ", "/@",
           " ", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", " ", "@", " ", 
                RowBox[{"Position", "[", " ", 
                 RowBox[{
                  RowBox[{"Simplify", " ", "/@", " ", 
                   RowBox[{"Abs", " ", "/@", " ", 
                    RowBox[{"Flatten", "[", "t1", "]"}]}]}], ",", " ", "#"}], 
                 "]"}]}], "&"}], ")"}], " ", "/@", " ", "t2"}], ")"}]}]}], 
         ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"dim", "^", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"dim", "^", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"rlist", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"result", ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "#"}], "}"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Position", "[", 
               RowBox[{"result", ",", " ", 
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"dim", "^", "4"}], "}"}]}], "]"}]}], "]"}]}], 
             ")"}]}], ")"}], "\[Rule]", "1"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.487563762358618*^9, 3.487563825257504*^9}, {
  3.487563856987354*^9, 3.487563927860917*^9}, {3.487564015011427*^9, 
  3.487564018876823*^9}, {3.487564060889729*^9, 3.487564223190574*^9}, {
  3.487564277000362*^9, 3.487564301197327*^9}, {3.487564337134785*^9, 
  3.487564374026128*^9}, {3.487564439008566*^9, 3.487564531185078*^9}}],

Cell["\<\
This function maps rho from Stormer lemma to kroneckized map, and in opposite \
direction\
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.488013385234382*^9, 3.488013400802499*^9}, {
  3.488015465956269*^9, 3.488015471459658*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"stormer2kron", "[", "rho_", "]"}], " ", ":=", " ", 
   RowBox[{"dekron", "[", 
    RowBox[{
     RowBox[{"uKroneckerProductRule", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Length", "[", "rho", "]"}], "]"}], "]"}], ".", 
     RowBox[{"kron", "[", 
      RowBox[{"rho", "\[Transpose]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kron2stormer", "[", "phi_", "]"}], ":=", 
   RowBox[{
    RowBox[{"dekron", "[", 
     RowBox[{
      RowBox[{"uKroneckerProductRule", "[", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Length", "[", "phi", "]"}], "]"}], "]"}], ".", 
      RowBox[{"kron", "[", "phi", "]"}]}], "]"}], "\[Transpose]"}]}], 
  ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.488013404705819*^9, 3.488013507047376*^9}, {
  3.488013563378377*^9, 3.488013568543111*^9}, {3.488015474104545*^9, 
  3.48801554330777*^9}}],

Cell["Fast versions, using precalculated matrices", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.48938659986954*^9, 3.489386610613126*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ukro3", " ", "=", " ", 
   RowBox[{"uKroneckerProductRule", "[", "3", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fastk2s3", "[", "phi_", "]"}], " ", ":=", " ", 
  RowBox[{"dekron", "[", 
   RowBox[{"ukro3", ".", 
    RowBox[{"kron", "[", "phi", "]"}]}], "]"}]}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.489386612285173*^9, 3.489386646965289*^9}}],

Cell["Analogue of findRho", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.489386382869828*^9, 3.489386387389438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findPhi", "[", 
   RowBox[{"f_", ",", "dim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", " ", "a"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", " ", "=", " ", 
      RowBox[{"makematrix", "[", 
       RowBox[{"\"\<a\>\"", ",", "dim"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"map", " ", "=", " ", 
      RowBox[{"makematrix", "[", 
       RowBox[{"\"\<map\>\"", ",", 
        RowBox[{"dim", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"map", " ", "/.", " ", 
      RowBox[{"(", 
       RowBox[{"Flatten", "@", 
        RowBox[{"SolveAlways", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"map", ".", 
            RowBox[{"kron", "[", "a", "]"}]}], " ", "\[Equal]", " ", 
           RowBox[{"kron", "[", 
            RowBox[{"f", "[", "a", "]"}], "]"}]}], ",", " ", 
          RowBox[{"Flatten", "@", "a"}]}], "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.489386257751589*^9, 3.489386336653527*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Obtaining map action for given Choi matrix", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728197839373*^9, 3.496728217359777*^9}}],

Cell["\<\
Given rho calculate action on arbitrary matrix.\
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.488529964244172*^9, 3.488529989523801*^9}, {
  3.593325402870202*^9, 3.5933254063812723`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"actbyrho", "[", 
     RowBox[{"rho_", ",", "m_"}], "]"}], ":=", " ", 
    RowBox[{"dekron", "[", 
     RowBox[{
      RowBox[{"stormer2kron", "[", "rho", "]"}], ".", 
      RowBox[{"kron", "[", "m", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"actByRho", "[", 
     RowBox[{"rho_", ",", "m_"}], "]"}], ":=", " ", 
    RowBox[{"dekron", "[", 
     RowBox[{
      RowBox[{"stormer2kron", "[", "rho", "]"}], ".", 
      RowBox[{"kron", "[", "m", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"partialActByRho", "[", 
     RowBox[{"rho_", ",", "m_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "ukro", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ukro", "=", 
        RowBox[{"uKroneckerProductRule", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Length", "[", "m", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dekron", "[", " ", 
        RowBox[{"ukro", ".", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", "m", "]"}], "]"}], ",", 
           RowBox[{"stormer2kron", "[", "rho", "]"}]}], "]"}], ".", "ukro", 
         ".", 
         RowBox[{"kron", "[", "m", "]"}]}], "]"}]}]}], "]"}]}]}], 
  "*)"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.488529994008618*^9, 3.488530052014232*^9}, {
  3.489387616232958*^9, 3.489387738483075*^9}, {3.489387829783646*^9, 
  3.489387832363544*^9}, {3.48938964655751*^9, 3.489389652316216*^9}, {
  3.489401633284899*^9, 3.489401639010487*^9}, {3.593325397250424*^9, 
  3.5933254000322247`*^9}}],

Cell["The correct way:", "Text",
 CellChangeTimes->{{3.5933254096773043`*^9, 3.593325412461471*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"actByRho", "[", "rho_", "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"m", ",", "\[IndentingNewLine]", 
    RowBox[{"partialTr", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "\[Transpose]"}], "\[CircleTimes]", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "m", "]"}], "]"}]}], ")"}], ".", "rho"}], 
      ",", "1"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5927458427354717`*^9, 3.5927458561271973`*^9}, {
  3.592745975475088*^9, 3.592746009195601*^9}, {3.592746050546364*^9, 
  3.5927460865046387`*^9}, {3.592746219822228*^9, 3.592746222102351*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Some other special functions", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728226991521*^9, 3.496728242223378*^9}}],

Cell[TextData[{
 "Now, let we see that the following gives us way to transform ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Rho]", "tr"], " "}], TraditionalForm]]],
 "to any arbitrary \[Rho][\[Xi], \[Eta], \[Zeta]] (numerical calculations):"
}], "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.486786493085093*^9, 3.486786549805477*^9}, {
  3.486786647730942*^9, 3.486786653186497*^9}, {3.486794623290704*^9, 
  3.486794655143969*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"transform", "[", 
    RowBox[{
    "rho_", ",", " ", "\[Xi]_", ",", "\[Eta]_", ",", " ", "\[Zeta]_"}], "]"}],
    " ", ":=", " ", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"ad", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"\[Xi]", ",", "\[Eta]", ",", 
          RowBox[{"\[Zeta]", "/", "2"}]}], "]"}], ".", 
        RowBox[{"\[Rho]", "[", 
         RowBox[{"\[Xi]", ",", 
          RowBox[{"\[Eta]", "/", "2"}], ",", " ", "0"}], "]"}], ".", 
        RowBox[{"\[Rho]", "[", 
         RowBox[{
          RowBox[{"\[Xi]", "/", "2"}], ",", "0", ",", "0"}], "]"}]}], ",", 
       "rho"}], "]"}], " ", "//", "N"}], "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.486786489014687*^9, 3.48678648998629*^9}, {
   3.486786559116819*^9, 3.486786836419578*^9}, {3.486786950148401*^9, 
   3.48678695328119*^9}, {3.486787370121778*^9, 3.486787440944815*^9}, {
   3.486794605257582*^9, 3.486794607724193*^9}, 3.486794641019974*^9, {
   3.487395455842486*^9, 3.487395460443453*^9}, {3.487395913131134*^9, 
   3.487395915134304*^9}, {3.488509876099511*^9, 3.488509890877122*^9}, {
   3.488510201658062*^9, 3.48851020211504*^9}, {3.488510592307318*^9, 
   3.488510592827963*^9}}],

Cell["Reverse transformation:", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.48679464802084*^9, 3.48679465360627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"transform2", "[", 
    RowBox[{
    "rho_", ",", " ", "\[Xi]_", ",", "\[Eta]_", ",", " ", "\[Zeta]_"}], "]"}],
    " ", ":=", " ", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"ad", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{
          RowBox[{"\[Xi]", "/", "2"}], ",", "0", ",", "0"}], "]"}], ".", " ", 
        
        RowBox[{"\[Rho]", "[", 
         RowBox[{"\[Xi]", ",", 
          RowBox[{"\[Eta]", "/", "2"}], ",", " ", "0"}], "]"}], ".", 
        RowBox[{"\[Rho]", "[", 
         RowBox[{"\[Xi]", ",", "\[Eta]", ",", 
          RowBox[{"\[Zeta]", "/", "2"}]}], "]"}]}], ",", "rho"}], "]"}], "//",
      "N"}], "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{
  3.486787786555471*^9, {3.486787905365683*^9, 3.486788001818529*^9}, {
   3.486789909279798*^9, 3.486789913322753*^9}, {3.487395465122413*^9, 
   3.487395468406627*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples of states, maps and Choi matrices", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728253743517*^9, 3.496728270863848*^9}, {
  3.504980480278794*^9, 3.504980487187192*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stormerExtreme", "[", 
   RowBox[{
   "\[Alpha]_", ",", " ", "\[Beta]_", ",", " ", "\[Gamma]_", ",", " ", 
    "\[Delta]_", ",", " ", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"x", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"\[Alpha]", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{"\[Beta]", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Conjugate", "[", "\[Alpha]", "]"}], " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Conjugate", "[", "\[Beta]", "]"}], 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"\[Gamma]", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Conjugate", "[", "\[Epsilon]", "]"}], 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{"\[Delta]", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.608354312099126*^9, 3.608354454605351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhoIdentity", " ", "=", " ", 
   RowBox[{"findRho", "[", 
    RowBox[{
     RowBox[{"#", "&"}], ",", "3"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.505329979088295*^9, 3.505329989374969*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhoTranspose", " ", "=", " ", 
   RowBox[{"findRhoChoi", "[", 
    RowBox[{"Transpose", ",", "3"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504980488595934*^9, 3.504980503930178*^9}}],

Cell["From the Example 1 of Terhal paper:", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.487575625087971*^9, 3.487575631789564*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "+", 
      RowBox[{"Sqrt", "[", "5", "]"}]}], "]"}]}]}], ";", " ", 
  RowBox[{"NN", " ", "=", " ", 
   RowBox[{"2", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"5", "+", 
      RowBox[{"Sqrt", "[", "5", "]"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.487575620834708*^9, 3.48757568042754*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", "i_", "]"}], " ", ":=", " ", 
   RowBox[{"NN", "  ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"i", "/", "5"}]}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"i", "/", "5"}]}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", "h", "}"}]}], "}"}]}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.48757568457191*^9, 3.487575790617034*^9}}],

Cell["This gives unextendible product basis (eq. 34):", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.487575983847408*^9, 3.487576004260608*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unextprodbase", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"v", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], " ", "&"}], "/@", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Mod", "[", " ", 
         RowBox[{
          RowBox[{"2", " ", "i"}], ",", " ", "5"}], "]"}]}], "}"}], ",", " ", 
      
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\

 InitializationGroup->True,
 CellChangeTimes->{{3.487575808693913*^9, 3.487575832981424*^9}, {
  3.487575877595455*^9, 3.487575972682325*^9}, {3.487578091229824*^9, 
  3.487578097701584*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unextRho", "[", "upb_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "dim", ",", " ", "S"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dim", " ", "=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"upb", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S", " ", "=", " ", 
      RowBox[{"Length", "[", "upb", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dim", "^", "2"}], "-", "S"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"dim", "^", "2"}], "]"}], " ", "-", 
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{"Sequence", " ", "@@", "#"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"proj", "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                RowBox[{"proj", "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], " ", "&"}], "/@",
              "upb"}], ")"}]}], ")"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.487576047194718*^9, 3.487576064708445*^9}, {
  3.487576527042545*^9, 3.487576653303133*^9}, {3.487576796540904*^9, 
  3.487576835979095*^9}, {3.48757697523501*^9, 3.487576976457103*^9}, {
  3.487582461835682*^9, 3.487582551868859*^9}, {3.487582786129746*^9, 
  3.487582788341056*^9}, {3.488771811261979*^9, 3.488771815047265*^9}}],

Cell["Choi map familly", "Text",
 CellChangeTimes->{{3.504979581700157*^9, 3.504979585227258*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Psi", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_", ",", "m_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DiagonalMatrix", "[", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", " ", 
       RowBox[{"m", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{"b", " ", 
       RowBox[{"m", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{"c", " ", 
       RowBox[{"m", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"a", " ", 
       RowBox[{"m", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{"b", " ", 
       RowBox[{"m", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{"c", " ", 
       RowBox[{"m", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"a", " ", 
       RowBox[{"m", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{"b", " ", 
       RowBox[{"m", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{"c", " ", 
       RowBox[{"m", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"choi", "[", "m_", "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"Psi", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "m"}], "]"}], " ", "-", " ", 
    "m"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"choiorig", "[", "m_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Psi", "[", 
     RowBox[{"2", ",", "2", ",", "2", ",", "m"}], "]"}], " ", "-", "m"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"choi", "[", 
    RowBox[{"m_", ",", "mu_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Psi", "[", 
     RowBox[{"2", ",", "0", ",", "mu", ",", "m"}], "]"}], " ", "-", "m"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"choi", "[", 
    RowBox[{"m_", ",", "a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Psi", "[", 
     RowBox[{"a", ",", "b", ",", "c", ",", "m"}], "]"}], " ", "-", "m"}]}], 
  ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.488699860572523*^9, 3.488699862616013*^9}, {
  3.488699896584611*^9, 3.488700049719517*^9}, {3.488700178217249*^9, 
  3.488700205437746*^9}, {3.488772329786483*^9, 3.488772341905919*^9}, {
  3.488775700538462*^9, 3.48877570114924*^9}, {3.488776860812317*^9, 
  3.488776861156059*^9}, {3.488777040932516*^9, 3.488777074001566*^9}, {
  3.488778613679478*^9, 3.488778614135457*^9}, {3.488778656084877*^9, 
  3.488778685469876*^9}, {3.488784425235021*^9, 3.488784426786789*^9}, {
  3.489379016778802*^9, 3.489379029533309*^9}, {3.489388719681603*^9, 
  3.489388747958859*^9}, {3.4893891224116*^9, 3.48938913560923*^9}, {
  3.489389352716889*^9, 3.489389360683959*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhoChoi", " ", "=", " ", 
   RowBox[{"findRhoChoi", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"choi", "[", "#", "]"}]}], "&"}], ",", "3"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.504979588103616*^9, 3.504979599959374*^9}}],

Cell["Terhal map and normalized Terhal map", "Text",
 CellChangeTimes->{{3.504979604946642*^9, 3.504979607075512*^9}, {
  3.504979688956009*^9, 3.504979693179248*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"terhalmu", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"4", "+", 
      RowBox[{"Sqrt", "[", "2", "]"}], "-", 
      RowBox[{"Sqrt", "[", "5", "]"}], "-", 
      RowBox[{"Sqrt", "[", "10", "]"}]}], ")"}], "/", "9"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"terhalproj", "[", 
    RowBox[{"i_", ",", "j_", ",", "mu_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Sequence", "@@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"e", "[", 
             RowBox[{"i", ",", "3"}], "]"}], "\[ConjugateTranspose]"}], ".", 
           RowBox[{"v", "[", "k", "]"}]}], ")"}]}]}], 
       RowBox[{"Sequence", "@@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "k", "]"}], "\[ConjugateTranspose]"}], ".", 
           RowBox[{"e", "[", 
            RowBox[{"j", ",", "3"}], "]"}]}], ")"}]}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"2", "k"}], ",", "5"}], "]"}], "]"}], ".", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"2", "k"}], ",", "5"}], "]"}], "]"}], 
          "\[ConjugateTranspose]"}]}], ")"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "4"}], "}"}]}], "]"}], " ", "-", " ", 
    RowBox[{"mu", " ", 
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"i", ",", "3"}], "]"}], ".", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"j", ",", "3"}], "]"}], "\[ConjugateTranspose]"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"terhalmap", "[", "m_", "]"}], " ", ":=", " ", 
   RowBox[{"Sum", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
      RowBox[{"terhalproj", "[", 
       RowBox[{"i", ",", "j", ",", "terhalmu"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"terhal", "[", "m_", "]"}], " ", ":=", " ", 
   RowBox[{"Sum", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
      RowBox[{"terhalproj", "[", 
       RowBox[{"i", ",", "j", ",", "terhalmu"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"terhalmap", "[", 
    RowBox[{"m_", ",", "mu_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Sum", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
      RowBox[{"terhalproj", "[", 
       RowBox[{"i", ",", "j", ",", "mu"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"terhalMapNormalizator", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"terhalmap", "[", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}], "]"}], "]"}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"normalizedTerhal", "[", "m_", "]"}], ":=", 
   RowBox[{"terhalMapNormalizator", ".", 
    RowBox[{"terhal", "[", "m", "]"}], ".", "terhalMapNormalizator"}]}], 
  ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.488700428029122*^9, 3.488700475486925*^9}, {
  3.488700510448868*^9, 3.488700664457171*^9}, {3.488700704411371*^9, 
  3.488700704570045*^9}, {3.488700766987965*^9, 3.488700866459692*^9}, {
  3.488700908561704*^9, 3.488700994842257*^9}, {3.488701155187269*^9, 
  3.488701157053722*^9}, {3.488777300797708*^9, 3.488777302618389*^9}, {
  3.489385525980141*^9, 3.4893855482343*^9}, {3.490334683044875*^9, 
  3.490334693796031*^9}, {3.490334746713684*^9, 3.490334747393154*^9}, {
  3.504979696785278*^9, 3.50497978810175*^9}, {3.504979830316878*^9, 
  3.50497984549849*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhoTerhal", " ", "=", " ", 
   RowBox[{"findRhoChoi", "[", 
    RowBox[{"terhal", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoNormalizedTerhal", " ", "=", " ", 
   RowBox[{"findRhoChoi", "[", 
    RowBox[{"normalizedTerhal", ",", "3"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.504979610596237*^9, 3.504979630272897*^9}, {
  3.504979762633973*^9, 3.504979768988642*^9}, {3.504979799255979*^9, 
  3.504979809664987*^9}, {3.504979850607118*^9, 3.504979851208297*^9}, {
  3.505149106311892*^9, 3.505149106686234*^9}}],

Cell["Examples of prof. Majewski", "Text",
 CellChangeTimes->{{3.504979944340228*^9, 3.504979948859039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhoMaj0", " ", "=", " ", 
   RowBox[{
    RowBox[{"proj", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
          RowBox[{"e", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
          RowBox[{"e", "[", 
           RowBox[{"1", ",", "3"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"proj", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], ")"}]}], "+", "\[IndentingNewLine]", 
    RowBox[{"proj", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], ")"}]}], "+", "\[IndentingNewLine]", 
    RowBox[{"proj", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], ")"}]}], "-", "\[IndentingNewLine]", 
    RowBox[{"proj", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
          RowBox[{"e", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
          RowBox[{"e", "[", 
           RowBox[{"1", ",", "3"}], "]"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.492922667914476*^9, 3.492922669086872*^9}, {
  3.492922703718257*^9, 3.492922813682045*^9}, {3.504979956478965*^9, 
  3.504980049024823*^9}, {3.50498014680633*^9, 3.504980146955167*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"maj0", "[", "m_", "]"}], ":=", 
   RowBox[{"actByRho", "[", 
    RowBox[{"rhoMaj0", ",", "m"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504980057978241*^9, 3.504980068660599*^9}, {
  3.504980149798685*^9, 3.504980174448458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"majGeneratingVectors", " ", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}], " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
         RowBox[{"e", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
         RowBox[{"e", "[", 
          RowBox[{"3", ",", "3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"3", ",", "3"}], "]"}], "\[CircleTimes]", 
         RowBox[{"e", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}]}], ")"}], ",", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
         RowBox[{"e", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"3", ",", "3"}], "]"}], "\[CircleTimes]", 
         RowBox[{"e", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
         RowBox[{"e", "[", 
          RowBox[{"3", ",", "3"}], "]"}]}]}], ")"}], ",", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
         RowBox[{"e", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
         RowBox[{"e", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"3", ",", "3"}], "]"}], "\[CircleTimes]", 
         RowBox[{"e", "[", 
          RowBox[{"3", ",", "3"}], "]"}]}]}], ")"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.504980210749637*^9, 3.504980283680115*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhoMaj1", " ", "=", " ", 
   RowBox[{"3", " ", 
    RowBox[{"partialTranspose", "[", 
     RowBox[{"proj", "@", 
      RowBox[{"majGeneratingVectors", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504980103872341*^9, 3.504980119671048*^9}, {
  3.504980162563146*^9, 3.50498016266111*^9}, {3.504980290149947*^9, 
  3.504980314440498*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"maj1", "[", "m_", "]"}], ":=", 
   RowBox[{"actByRho", "[", 
    RowBox[{"rhoMaj1", ",", "m"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504980125280235*^9, 3.504980134215668*^9}, {
  3.504980167663461*^9, 3.504980169752949*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhoMaj2", "=", 
   RowBox[{"3", " ", 
    RowBox[{"partialTranspose", "[", 
     RowBox[{"proj", "@", 
      RowBox[{"majGeneratingVectors", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.492922816121334*^9, 3.492922834051877*^9}, {
   3.504979964359972*^9, 3.504979970504829*^9}, 3.50498019001588*^9, {
   3.504980318685086*^9, 3.504980329808092*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"maj2", "[", "m_", "]"}], ":=", 
   RowBox[{"actByRho", "[", 
    RowBox[{"rhoMaj2", ",", "m"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504980125280235*^9, 3.504980134215668*^9}, {
  3.504980167663461*^9, 3.504980169752949*^9}, {3.504980339375411*^9, 
  3.504980341840169*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhoMaj3", "=", 
   RowBox[{"3", " ", 
    RowBox[{"partialTranspose", "[", 
     RowBox[{"proj", "@", 
      RowBox[{"majGeneratingVectors", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504980352497779*^9, 3.504980355554831*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"maj3", "[", "m_", "]"}], ":=", 
   RowBox[{"actByRho", "[", 
    RowBox[{"rhoMaj3", ",", "m"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504980125280235*^9, 3.504980134215668*^9}, {
  3.504980167663461*^9, 3.504980169752949*^9}, {3.504980345526914*^9, 
  3.504980347605874*^9}}],

Cell["\<\
Some maps for 4D case. Robertson map. Note that this is atomic and \
indecomposable map.\
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.48878093864516*^9, 3.488780945285001*^9}, {
  3.496072662657631*^9, 3.496072668960637*^9}, {3.496072702752831*^9, 
  3.49607270855346*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"robertsonred", "[", "m_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "2", "]"}], " ", 
     RowBox[{"Tr", "[", "m", "]"}]}], " ", "-", " ", "m"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"robertsonmap", "[", "m_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r11", ",", " ", "r12", ",", " ", "r21", ",", "r22"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r11", " ", "=", " ", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], " ", 
        RowBox[{"Tr", "[", " ", 
         RowBox[{"m", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"3", ";;", "4"}], ",", 
            RowBox[{"3", ";;", "4"}]}], "]"}], "]"}], " ", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r22", " ", "=", " ", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], " ", 
        RowBox[{"Tr", "[", " ", 
         RowBox[{"m", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "2"}], ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], " ", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r12", " ", "=", " ", 
       RowBox[{
        RowBox[{"m", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "2"}], ",", " ", 
           RowBox[{"3", ";;", "4"}]}], "]"}], "]"}], "+", 
        RowBox[{"robertsonred", "[", " ", 
         RowBox[{"m", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"3", ";;", "4"}], ",", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], " ", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r21", " ", "=", " ", 
       RowBox[{
        RowBox[{"m", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"3", ";;", "4"}], ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], " ", "+", 
        RowBox[{"robertsonred", "[", " ", 
         RowBox[{"m", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "2"}], ",", 
            RowBox[{"3", ";;", "4"}]}], "]"}], "]"}], " ", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r11", ",", "r12"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r21", ",", "r22"}], "}"}]}], "}"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.488780947605193*^9, 3.488780952718415*^9}, {
  3.488781633918052*^9, 3.488781872671871*^9}, {3.48878198206324*^9, 
  3.488782022128326*^9}, {3.488859638081948*^9, 3.488859638325362*^9}, {
  3.489484574920285*^9, 3.489484577287423*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p0", "[", "dim_", "]"}], " ", ":=", " ", 
  RowBox[{"proj", "@", 
   RowBox[{"(", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"i", ",", "dim"}], "]"}], ",", 
          RowBox[{"e", "[", 
           RowBox[{"i", ",", "dim"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}], ")"}]}], 
    ")"}]}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.490332698524983*^9, 3.490332702404412*^9}, {
  3.490332733354128*^9, 3.490332836498619*^9}}],

Cell["Terhal state:", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728393839727*^9, 3.49672841108786*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unextrho", " ", "=", " ", 
   RowBox[{"unextRho", "[", "unextprodbase", "]"}]}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.487576838358369*^9, 3.487576844831336*^9}, {
  3.487576981784354*^9, 3.487576984415084*^9}, {3.487577016596078*^9, 
  3.487577023164132*^9}}],

Cell["Horodecki state:", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728405631698*^9, 3.496728413295779*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hrho", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", "q"}], "+", "1"}], ")"}]}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", "0", ",", "0", ",", "0", ",", "q", ",", "0", ",", "0", ",", 
        "0", ",", "q"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "q", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "q", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "q", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "q", ",", "0", ",", "0", ",", "0", ",", "q", ",", "0", ",", "0", ",", 
        "0", ",", "q"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "q", ",", "0", ",", 
        "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}]}], ",", " ", "0", ",", " ", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"q", "^", "2"}]}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "q", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", "0", ",", "0", ",", "q", ",", "0", ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"q", "^", "2"}]}], "]"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", "q"}], ")"}]}]}], "}"}]}], "}"}]}]}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{3.494825769389018*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Map testing", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.496728284799454*^9, 3.496728286607537*^9}, 
   3.50514909634467*^9}],

Cell["Function for random test of positivity of a map.", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.488780920388795*^9, 3.488780932757043*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"randomPositivityTest", "[", 
   RowBox[{"phi_", ",", "nb_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "rm", ",", 
      RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{"i", ",", 
       RowBox[{"i", "<", "nb"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", " ", "=", "  ", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}]}], "]"}], " ", "+", " ", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rm", " ", "=", " ", 
         RowBox[{
          RowBox[{"phi", "[", 
           RowBox[{
            RowBox[{"t", "\[ConjugateTranspose]"}], ".", "t"}], "]"}], " ", "//",
           "Chop"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "@", 
            RowBox[{"Chop", "@", 
             RowBox[{"Eigenvalues", "[", "rm", "]"}]}]}], " ", "<", "0"}], 
          ",", " ", "\[IndentingNewLine]", "\t", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "==", "nb"}], ",", "True", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Min", "@", 
          RowBox[{"Chop", "@", 
           RowBox[{"Eigenvalues", "[", "rm", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"t", "\[ConjugateTranspose]"}], ".", "t"}]}], "}"}]}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomCheckNormalization", "[", 
    RowBox[{"map_", ",", "trials_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "rm", ",", 
       RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{"i", ",", 
        RowBox[{"i", "<", "trials"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "=", " ", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "3"}], "}"}]}], "]"}], " ", "+", " ", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rm", " ", "=", " ", 
          RowBox[{"map", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", "rm", "]"}], ">", 
            RowBox[{"Norm", "[", "t", "]"}]}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "trials"}], ",", "True", ",", "False"}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomNorm", "[", 
    RowBox[{"map_", ",", "trials_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "rm", ",", 
       RowBox[{"i", "=", "0"}], ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{"i", ",", 
        RowBox[{"i", "<", "trials"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "=", " ", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "3"}], "}"}]}], "]"}], " ", "+", " ", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rm", " ", "=", " ", 
          RowBox[{"map", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", "rm", "]"}], "/", 
             RowBox[{"Norm", "[", "t", "]"}]}], "\[GreaterEqual]", "n"}], ",", 
           RowBox[{"n", "=", 
            RowBox[{
             RowBox[{"Norm", "[", "rm", "]"}], "/", 
             RowBox[{"Norm", "[", "t", "]"}]}]}], ",", "Null"}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", "n"}]}], "]"}]}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.487997927942725*^9, 3.487998247104592*^9}, {
  3.487998340222372*^9, 3.487998374245457*^9}, {3.489484312546831*^9, 
  3.489484451896832*^9}, {3.489484581897952*^9, 3.489484622745437*^9}, {
  3.489484654811592*^9, 3.48948469370527*^9}, {3.48948473678897*^9, 
  3.48948476127144*^9}, {3.489484796782458*^9, 3.489484810074813*^9}, {
  3.489484871767752*^9, 3.489484962531248*^9}, {3.489727399057401*^9, 
  3.489727439717967*^9}, {3.489727526374105*^9, 3.489727543164218*^9}, {
  3.5369906295834208`*^9, 3.536990673561665*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"randomPositivityTest", "[", 
   RowBox[{"phi_", ",", "nb_", ",", "dim_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "rm", ",", 
      RowBox[{"i", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{"i", ",", 
       RowBox[{"i", "<", "nb"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", " ", "=", "  ", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], " ", "+", " ", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rm", " ", "=", " ", 
         RowBox[{
          RowBox[{"phi", "[", 
           RowBox[{
            RowBox[{"t", "\[ConjugateTranspose]"}], ".", "t"}], "]"}], " ", "//",
           "Chop"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "@", 
            RowBox[{"Chop", "@", 
             RowBox[{"Eigenvalues", "[", "rm", "]"}]}]}], " ", "<", "0"}], 
          ",", " ", "\[IndentingNewLine]", "\t", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "==", "nb"}], ",", "True", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Min", "@", 
          RowBox[{"Chop", "@", 
           RowBox[{"Eigenvalues", "[", "rm", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"t", "\[ConjugateTranspose]"}], ".", "t"}]}], "}"}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.492924725768784*^9, 3.492924738387581*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"makeRandomBpTest", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Chop", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "\[ConjugateTranspose]"}], ".", "s", ".", "#"}], 
          ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}]}], ",", "#"}], "}"}], 
    "&"}], "[", 
   RowBox[{"CircleTimes", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "\[Transpose]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}]}]}], 
        ",", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}]}]}]}], 
       "}"}]}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"randomBpTest", "[", 
   RowBox[{"s_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"makeRandomBpTest", "[", "s", "]"}], ",", " ", 
      RowBox[{"{", "n", "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], "&"}]}], "]"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"makeRandomBpTest", "[", 
   RowBox[{"s_", ",", "dim_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Chop", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "\[ConjugateTranspose]"}], ".", "s", ".", "#"}], 
          ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}]}], ",", "#"}], "}"}], 
    "&"}], "[", 
   RowBox[{"CircleTimes", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "\[Transpose]"}], "/", 
        RowBox[{"Norm", "[", "#", "]"}]}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "dim"}], "]"}], "+", 
         
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "dim"}], "]"}]}]}], 
        ",", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "dim"}], "]"}], "+", 
         
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "dim"}], 
           "]"}]}]}]}], "}"}]}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"randomBpTest", "[", 
   RowBox[{"s_", ",", "dim_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"makeRandomBpTest", "[", 
       RowBox[{"s", ",", "dim"}], "]"}], ",", " ", 
      RowBox[{"{", "n", "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], "&"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.552626106767866*^9, 3.5526261470597754`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"antimorphismQ", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"mx", "[", 
         RowBox[{"\"\<a\>\"", ",", "3"}], "]"}]}], ",", 
       RowBox[{"b", "=", 
        RowBox[{"mx", "[", 
         RowBox[{"\"\<b\>\"", ",", "3"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"a", ".", "b"}], "]"}], " ", "-", " ", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "b", "]"}], ".", 
         RowBox[{"\[Phi]", "[", "a", "]"}]}]}], "\[Equal]", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "//", "FullSimplify"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"morphismQ", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"mx", "[", 
         RowBox[{"\"\<a\>\"", ",", "3"}], "]"}]}], ",", 
       RowBox[{"b", "=", 
        RowBox[{"mx", "[", 
         RowBox[{"\"\<b\>\"", ",", "3"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"a", ".", "b"}], "]"}], " ", "-", " ", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "a", "]"}], ".", 
         RowBox[{"\[Phi]", "[", "b", "]"}]}]}], "\[Equal]", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "//", "FullSimplify"}]}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.55261081122575*^9, 3.5526108490188704`*^9}, {
  3.55261092692165*^9, 3.552610962310624*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"antimorphismQ", "[", 
    RowBox[{"\[Phi]_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"mx", "[", 
         RowBox[{"\"\<a\>\"", ",", "dim"}], "]"}]}], ",", 
       RowBox[{"b", "=", 
        RowBox[{"mx", "[", 
         RowBox[{"\"\<b\>\"", ",", "dim"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"a", ".", "b"}], "]"}], " ", "-", " ", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "b", "]"}], ".", 
         RowBox[{"\[Phi]", "[", "a", "]"}]}]}], "\[Equal]", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], "//", 
      "FullSimplify"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"morphismQ", "[", 
    RowBox[{"\[Phi]_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"mx", "[", 
         RowBox[{"\"\<a\>\"", ",", "dim"}], "]"}]}], ",", 
       RowBox[{"b", "=", 
        RowBox[{"mx", "[", 
         RowBox[{"\"\<b\>\"", ",", "dim"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"a", ".", "b"}], "]"}], " ", "-", " ", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "a", "]"}], ".", 
         RowBox[{"\[Phi]", "[", "b", "]"}]}]}], "\[Equal]", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], "//", 
      "FullSimplify"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.552626261126195*^9, 3.552626292209292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bpTest", "[", 
   RowBox[{"rho_", ",", "x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"x", "\[CircleTimes]", "y"}], ",", " ", 
     RowBox[{"rho", ".", 
      RowBox[{"(", 
       RowBox[{"x", "\[CircleTimes]", "y"}], ")"}]}]}], 
    "\[RightAngleBracket]"}], " ", "\[GreaterEqual]", "0"}]}]], "Input",
 CellChangeTimes->{{3.609123617438032*^9, 3.609123645779869*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Inner products and coefficients\
\>", "Subsection",
 CellChangeTimes->{{3.58814750393005*^9, 3.588147518142818*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HSinner", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"a", "\[ConjugateTranspose]"}], ".", "b"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HScoeff", "[", 
    RowBox[{"a_", ",", "i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Sqrt", "@", 
        RowBox[{"Length", "@", "a"}]}]}], "}"}], ",", 
     RowBox[{"HSinner", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"proj", "[", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"i", ",", "n"}], "]"}], ",", 
          RowBox[{"e", "[", 
           RowBox[{"j", ",", "n"}], "]"}]}], "]"}], "\[CircleTimes]", 
        RowBox[{"proj", "[", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"k", ",", "n"}], "]"}], ",", 
          RowBox[{"e", "[", 
           RowBox[{"l", ",", "n"}], "]"}]}], "]"}]}], ",", "a"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partialMap", "[", 
   RowBox[{"map_", ",", "a_"}], "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}], ",", 
         RowBox[{
          RowBox[{"HScoeff", "[", 
           RowBox[{"a", ",", "i", ",", "j", ",", "k", ",", "l"}], "]"}], " ", 
          
          RowBox[{
           RowBox[{"proj", "[", 
            RowBox[{
             RowBox[{"e", "[", "i", "]"}], ",", 
             RowBox[{"e", "[", "j", "]"}]}], "]"}], "\[CircleTimes]", 
           RowBox[{"map", "[", 
            RowBox[{"proj", "[", 
             RowBox[{
              RowBox[{"e", "[", "k", "]"}], ",", 
              RowBox[{"e", "[", "l", "]"}]}], "]"}], "]"}]}]}]}], "]"}], "[", 
       
       RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Tuples", "[", 
      RowBox[{
       RowBox[{"Range", "[", "3", "]"}], ",", "4"}], "]"}]}], 
    ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.552967891521946*^9, 3.55296795440378*^9}, {
  3.552969596829255*^9, 3.552969597564919*^9}, {3.580028126543709*^9, 
  3.5800281281698523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vecCoeff", "[", 
    RowBox[{"v_", ",", "i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"Transpose", "@", "v"}]}]}], "}"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", 
         RowBox[{"i", ",", "n"}], "]"}], "\[CircleTimes]", 
        RowBox[{"e", "[", 
         RowBox[{"j", ",", "n"}], "]"}]}], ",", "v"}], 
      "\[RightAngleBracket]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.552967959278426*^9, 3.552968025389551*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Alpha norm calculations and Gateaux derivatives", "Subsection",
 CellChangeTimes->{{3.505110689954511*^9, 3.505110700081088*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GellMannMatrices", " ", "=", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ")"}], ",", "\n", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "I"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"I", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ")"}], ",", "\n", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ")"}], ",", "\n", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], ")"}], ",", "\n", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "I"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"I", ",", "0", ",", "0"}], "}"}]}], "}"}], ")"}], ",", "\n", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ")"}], ",", "\n", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "I"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "I", ",", "0"}], "}"}]}], "}"}], ")"}], ",", "\n", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "/", "3"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "}"}], ")"}]}], ",", "\n", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ")"}]}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"su", "[", "angles_", "]"}], ":=", 
  RowBox[{"Dot", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"MatrixExp", "[", 
       RowBox[{"I", " ", 
        RowBox[{"GellMannMatrices", "[", 
         RowBox[{"[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], " ", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "3", ",", "2", ",", "3", ",", "5", ",", "3", ",", "2", ",", "3", 
           ",", "8"}], "}"}], ",", "angles"}], "}"}], "\[Transpose]"}], 
      ")"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.505110710272242*^9, 3.505110787425989*^9}, {
  3.505110905399149*^9, 3.505110910236787*^9}, {3.505111002496694*^9, 
  3.505111004394508*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"basis3", "[", "alpha_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"su", "[", "alpha", "]"}], ".", "#"}], " ", "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"1", ",", "3"}], "]"}], ",", 
     RowBox[{"e", "[", 
      RowBox[{"2", ",", "3"}], "]"}], ",", 
     RowBox[{"e", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.503048318023939*^9, 3.503048367425741*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bsyms3", "[", "basis_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"proj", "[", 
      RowBox[{"basis", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
     RowBox[{"proj", "[", 
      RowBox[{"basis", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", 
     RowBox[{"proj", "[", 
      RowBox[{"basis", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", "  ", 
    RowBox[{
     RowBox[{"proj", "[", 
      RowBox[{"basis", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", 
     RowBox[{"proj", "[", 
      RowBox[{"basis", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], "-", 
     RowBox[{"proj", "[", 
      RowBox[{"basis", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"proj", "[", 
      RowBox[{"basis", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], "+", 
     RowBox[{"proj", "[", 
      RowBox[{"basis", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
     RowBox[{"proj", "[", 
      RowBox[{"basis", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.503048390753731*^9, 3.503048489574831*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sym3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"alpha", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<\[Alpha]\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"bsyms3", "[", 
      RowBox[{"basis3", "[", "alpha", "]"}], "]"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.503048372344311*^9, 3.503048375736578*^9}, {
   3.503048492468355*^9, 3.503048528735649*^9}, 3.50304862528413*^9, {
   3.505126371712206*^9, 3.505126403389545*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.593335504522579*^9, 3.593335505821186*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NAlphaNorm", "[", "m_", "]"}], ":=", " ", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "}"}], 
        "\[Transpose]"}]}], ",", 
      RowBox[{"alpha", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<\[Alpha]\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NMaxValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Abs", "@", 
            RowBox[{"Tr", "[", 
             RowBox[{"m", ".", 
              RowBox[{"(", 
               RowBox[{"#", "\[CircleTimes]", 
                RowBox[{"proj", "@", "x"}]}], ")"}]}], "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"Norm", "[", "x", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
         
         RowBox[{"Flatten", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"alpha", ",", "x"}], "]"}], "]"}]}], "]"}], " ", "&"}], "/@",
       " ", "sym3"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.503066859593762*^9, 3.503066939995998*^9}, {
  3.50306697871939*^9, 3.503066979321571*^9}, {3.503070272306753*^9, 
  3.503070317485768*^9}, {3.505111021133789*^9, 3.505111031282062*^9}, {
  3.505111092546037*^9, 3.505111125554506*^9}, {3.593325824691991*^9, 
  3.593325843924815*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NAlphaNormResult", "[", "m_", "]"}], ":=", " ", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "}"}], 
        "\[Transpose]"}]}], ",", 
      RowBox[{"alpha", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<\[Alpha]\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NMaximize", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Abs", "@", 
           RowBox[{"Tr", "[", 
            RowBox[{"m", ".", 
             RowBox[{"(", 
              RowBox[{"#", "\[CircleTimes]", 
               RowBox[{"proj", "@", "x"}]}], ")"}]}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"Norm", "[", "x", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"alpha", ",", "x"}], "]"}], "]"}]}], "]"}], " ", "&"}], "/@",
      " ", "sym3"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.505154677654938*^9, 3.505154746424123*^9}, {
  3.505154858894019*^9, 3.505154866860549*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"alphaNormGateauxDiff", "[", 
   RowBox[{"x_", ",", "y_", ",", "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NAlphaNorm", "[", 
      RowBox[{"x", "+", 
       RowBox[{"\[Lambda]", " ", "y"}]}], "]"}], " ", "-", " ", 
     RowBox[{"NAlphaNorm", "[", "x", "]"}]}], ")"}], "/", 
   "\[Lambda]"}]}]], "Input",
 CellChangeTimes->{{3.503069965914754*^9, 3.503070018985334*^9}, {
  3.50511127222069*^9, 3.505111284074976*^9}, {3.505111323782569*^9, 
  3.505111324342302*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NAlphaNormBP", "[", "m_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "}"}], 
        "\[Transpose]"}]}], "}"}], ",", 
     RowBox[{"NMaxValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Abs", "@", 
          RowBox[{"Tr", "[", 
           RowBox[{"m", ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "3", "]"}], "\[CircleTimes]", 
              RowBox[{"(", 
               RowBox[{"proj", "@", "x"}], ")"}]}], ")"}]}], "]"}]}], ",", 
         " ", 
         RowBox[{
          RowBox[{"Norm", "[", "x", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
       RowBox[{"Flatten", "[", "x", "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.503215772197593*^9, 3.503215876634545*^9}, {
  3.503215941342244*^9, 3.503215955127118*^9}, {3.503216011527746*^9, 
  3.503216014102178*^9}, {3.505111391412401*^9, 3.505111426995008*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Useful operations", "Subsection",
 CellChangeTimes->{{3.5287683592367907`*^9, 3.528768364008513*^9}}],

Cell[TextData[{
 "Functions performing partial traces of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", " "}], TraditionalForm]]],
 "with respect to first and second subsystem"
}], "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.515227338640347*^9, 3.515227352127457*^9}, {
  3.519521348772149*^9, 3.519521355209851*^9}, {3.51952153691229*^9, 
  3.51952154286819*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"partialTr", "[", 
   RowBox[{"m_", ",", "2"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Length", "@", "m"}]}]}], "}"}], ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"m", ".", 
           RowBox[{"proj", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", 
               RowBox[{"i", ",", "n"}], "]"}], "\[CircleTimes]", 
              RowBox[{"e", "[", 
               RowBox[{"k", ",", "n"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", 
               RowBox[{"j", ",", "n"}], "]"}], "\[CircleTimes]", 
              RowBox[{"e", "[", 
               RowBox[{"k", ",", "n"}], "]"}]}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}], " ", 
       RowBox[{"proj", "[", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"j", ",", "n"}], "]"}], ",", 
         RowBox[{"e", "[", 
          RowBox[{"i", ",", "n"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], " ", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partialTr", "[", 
   RowBox[{"m_", ",", "1"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Length", "@", "m"}]}]}], "}"}], ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"m", ".", 
           RowBox[{"proj", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", 
               RowBox[{"k", ",", "n"}], "]"}], "\[CircleTimes]", 
              RowBox[{"e", "[", 
               RowBox[{"i", ",", "n"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", 
               RowBox[{"k", ",", "n"}], "]"}], "\[CircleTimes]", 
              RowBox[{"e", "[", 
               RowBox[{"j", ",", "n"}], "]"}]}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}], " ", 
       RowBox[{"proj", "[", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"j", ",", "n"}], "]"}], ",", 
         RowBox[{"e", "[", 
          RowBox[{"i", ",", "n"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], " ", "]"}]}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.51522662745168*^9, 3.515226738493541*^9}, {
   3.515226775983163*^9, 3.515226823726655*^9}, {3.515226882192539*^9, 
   3.515226884832548*^9}, {3.515227082926351*^9, 3.515227096096118*^9}, {
   3.515227185165647*^9, 3.515227256845175*^9}, {3.515227325628397*^9, 
   3.51522732666183*^9}, 3.528768323185487*^9}],

Cell["Detects entanglement of a pure state:", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.516693080011904*^9, 3.516693089067832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pureStateEntangledQ", "[", "v_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"partialTr", "[", 
         RowBox[{
          RowBox[{"proj", "@", "v"}], ",", "1"}], "]"}], ".", 
        RowBox[{"partialTr", "[", 
         RowBox[{
          RowBox[{"proj", "@", "v"}], ",", "1"}], "]"}]}], "]"}], "<", "1"}], 
     ",", "True", ",", "False"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.515990207457926*^9, 3.515990248798595*^9}, 
   3.51661231486731*^9}],

Cell[TextData[{
 "This function performs unitary operation that transforms basis ",
 StyleBox["b1", "Input"],
 " to ",
 StyleBox["b2", "Input"],
 " on vector ",
 StyleBox["v", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.528768409016305*^9, 3.5287684661906157`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ubasetransform", "[", 
    RowBox[{"v_", ",", "b1_", ",", "b2_"}], "]"}], ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"b1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[ConjugateTranspose]"}], ".", 
         "v"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
      RowBox[{"b2", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "v", "]"}]}], "}"}]}], "]"}]}], ";"}]], "Input",\

 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.516094500844385*^9, 3.51609451768106*^9}, {
  3.516094547826151*^9, 3.516094554834865*^9}, {3.516094601317751*^9, 
  3.516094620044771*^9}, {3.516094761795211*^9, 3.516094811942633*^9}, {
  3.516612288447663*^9, 3.516612292174807*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Schmidt decomposition", "Subsection",
 CellChangeTimes->{{3.5881475264703283`*^9, 3.588147531422311*^9}, 
   3.588147577179913*^9}],

Cell[TextData[{
 "This computes Schmidt coefficients of a given state ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]]],
 ":"
}], "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.515990711309949*^9, 3.515990739948733*^9}, {
  3.519521500391584*^9, 3.519521526379336*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"schmidtCoeff", "[", "v_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Length", "@", "v"}]}]}], "}"}], ",", 
    RowBox[{"SingularValueList", "@", 
     RowBox[{"ArrayFlatten", "@", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"e", "[", 
             RowBox[{"i", ",", "n"}], "]"}], "\[CircleTimes]", 
            RowBox[{"e", "[", 
             RowBox[{"j", ",", "n"}], "]"}]}], ")"}], 
          "\[ConjugateTranspose]"}], ".", "v"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.515990556872267*^9, 3.515990601023712*^9}, {
  3.519541015815398*^9, 3.519541043653344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"schmidtDecomposition", "[", "v_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Diagonal", "@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"#", ">", "0"}], "&"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Transpose]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Transpose]"}]}], "}"}], 
        "\[Transpose]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"Length", "@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Diagonal", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "}"}], "&"}], "[", 
   RowBox[{"SingularValueDecomposition", "@", 
    RowBox[{"ArrayFlatten", "@", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"e", "[", 
            RowBox[{"i", ",", "3"}], "]"}], "\[CircleTimes]", 
           RowBox[{"e", "[", 
            RowBox[{"j", ",", "3"}], "]"}]}], ")"}], 
         "\[ConjugateTranspose]"}], ".", "v"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.519377247698048*^9, 3.519377250688993*^9}, {
  3.519382110151141*^9, 3.519382124247294*^9}, {3.519382290220172*^9, 
  3.519382320626798*^9}, {3.5193823548374*^9, 3.519382503494634*^9}}],

Cell[TextData[{
 "This computes Schmidt coefficients of a given state ",
 Cell[BoxData[
  FormBox["v", TraditionalForm]]],
 ":"
}], "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.515990711309949*^9, 3.515990739948733*^9}, {
  3.519521500391584*^9, 3.519521526379336*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"schmidtCoeff", "[", "v_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Length", "@", "v"}]}]}], "}"}], ",", 
    RowBox[{"SingularValueList", "@", 
     RowBox[{"ArrayFlatten", "@", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"e", "[", 
             RowBox[{"i", ",", "n"}], "]"}], "\[CircleTimes]", 
            RowBox[{"e", "[", 
             RowBox[{"j", ",", "n"}], "]"}]}], ")"}], 
          "\[ConjugateTranspose]"}], ".", "v"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.515990556872267*^9, 3.515990601023712*^9}, {
  3.519541015815398*^9, 3.519541043653344*^9}}],

Cell[TextData[{
 "And the Schmidt decomposition of a given state ",
 StyleBox["v", "Input"]
}], "Text",
 CellChangeTimes->{{3.528768518261862*^9, 3.528768534870359*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"schmidtDecomposition", "[", "v_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Sqrt", "@", 
       RowBox[{"Length", "@", "v"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Diagonal", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"#", ">", "0"}], "&"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Transpose]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Transpose]"}]}], "}"}], 
          "\[Transpose]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"Length", "@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Diagonal", "@", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "}"}], "&"}], "[", 
     RowBox[{"SingularValueDecomposition", "@", 
      RowBox[{"ArrayFlatten", "@", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"e", "[", 
              RowBox[{"i", ",", "n"}], "]"}], "\[CircleTimes]", 
             RowBox[{"e", "[", 
              RowBox[{"j", ",", "n"}], "]"}]}], ")"}], 
           "\[ConjugateTranspose]"}], ".", "v"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.519377247698048*^9, 3.519377250688993*^9}, {
  3.519382110151141*^9, 3.519382124247294*^9}, {3.519382290220172*^9, 
  3.519382320626798*^9}, {3.5193823548374*^9, 3.519382503494634*^9}, {
  3.548953057045841*^9, 3.548953078255041*^9}}],

Cell["Normalize column vector:", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.516693066123017*^9, 3.516693076841852*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"columnNormalize", "[", "v_", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Normalize", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "v", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "}"}], 
   "\[Transpose]"}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.515992262466476*^9, 3.515992284388222*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Tensor decomposable matrix", "Subsection",
 CellChangeTimes->{{3.588147551270349*^9, 3.588147557365498*^9}}],

Cell["\<\
Functions used to check if the unitary matrix is tensor decomposable, based \
on arxiv:quant-ph/0506135v1\
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.518334758187135*^9, 3.518334789530188*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"revec", "[", "a_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{"Length", "@", "a"}]}], ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"Transpose", "@", "a"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "m"}], ",", "i"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ")"}]}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rearrangedMatrix", "[", 
    RowBox[{"a_", ",", "bs_"}], "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"revec", "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Partition", "[", " ", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{"bs", ",", "bs"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
       ")"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rearrangedMatrix", "[", "a_", "]"}], ":=", 
   RowBox[{"rearrangedMatrix", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"Length", "[", "a", "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.518334673727761*^9, 3.518334720716595*^9}, {
  3.518334755355394*^9, 3.518334755752134*^9}}],

Cell[TextData[{
 StyleBox["MatrixRank", "Input"],
 " of rearranged unitary matrix is equal one iff unitary matrix is tensor \
decomposable."
}], "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.518334832104705*^9, 3.518334908662672*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Definitions of entangled states", "Subsection",
 CellChangeTimes->{{3.51669313991077*^9, 3.516693146006229*^9}, {
  3.519523327201452*^9, 3.519523334144118*^9}, {3.5881475842438*^9, 
  3.588147594198702*^9}}],

Cell["At least some definitions, but with no use now.", "Text",
 CellChangeTimes->{{3.519523284842248*^9, 3.519523306377522*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stateEPR", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.515989930360258*^9, 3.51599001002254*^9}, {
  3.528768628105485*^9, 3.5287686403259497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stateEPRm", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.515990756142061*^9, 3.51599076017583*^9}, {
  3.5287686004398623`*^9, 3.528768601480604*^9}, {3.528768648173955*^9, 
  3.52876865776766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stateEPR3", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.515990531876997*^9, 3.515990548774427*^9}, {
  3.515990620960362*^9, 3.515990652183597*^9}, {3.5287686714722233`*^9, 
  3.5287686773518476`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stateEPR3m", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "\[CircleTimes]", 
       RowBox[{"e", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.515991226054249*^9, 3.515991245945806*^9}, {
  3.528768682375305*^9, 3.528768687231544*^9}}]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{640, 699},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 182, 3, 80, "Section",
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[774, 29, 138, 2, 44, "Subsection",
 InitializationGroup->True],
Cell[915, 33, 225, 4, 30, "Text",
 InitializationGroup->True],
Cell[1143, 39, 355, 9, 30, "Input",
 InitializationGroup->True],
Cell[1501, 50, 275, 7, 28, "Input",
 InitializationGroup->True],
Cell[1779, 59, 505, 13, 30, "Input"],
Cell[2287, 74, 294, 9, 28, "Input",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2618, 88, 147, 2, 36, "Subsection",
 InitializationGroup->True],
Cell[2768, 92, 156, 2, 30, "Text",
 InitializationGroup->True],
Cell[2927, 96, 755, 19, 63, "Input",
 InitializationGroup->True],
Cell[3685, 117, 259, 6, 50, "Text",
 InitializationGroup->True],
Cell[3947, 125, 588, 16, 46, "Input",
 InitializationGroup->True],
Cell[4538, 143, 558, 15, 46, "Input",
 InitializationGroup->True],
Cell[5099, 160, 779, 21, 63, "Input",
 InitializationGroup->True],
Cell[5881, 183, 192, 4, 30, "Text",
 InitializationGroup->True],
Cell[6076, 189, 2625, 78, 97, "Input",
 InitializationGroup->True],
Cell[8704, 269, 141, 2, 30, "Text",
 InitializationGroup->True],
Cell[8848, 273, 3107, 95, 148, "Input",
 InitializationGroup->True],
Cell[11958, 370, 416, 12, 48, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[12411, 387, 133, 2, 36, "Subsection",
 InitializationGroup->True],
Cell[12547, 391, 236, 5, 49, "Text",
 InitializationGroup->True],
Cell[12786, 398, 5975, 151, 335, "Input",
 InitializationGroup->True],
Cell[18764, 551, 1396, 35, 97, "Input",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[20197, 591, 135, 2, 36, "Subsection",
 InitializationGroup->True],
Cell[20335, 595, 731, 19, 58, "Input",
 InitializationGroup->True],
Cell[21069, 616, 620, 17, 58, "Input",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[21726, 638, 185, 4, 36, "Subsection",
 InitializationGroup->True],
Cell[21914, 644, 210, 3, 31, "Text",
 InitializationGroup->True],
Cell[22127, 649, 2135, 53, 231, "Input",
 InitializationGroup->True],
Cell[24265, 704, 449, 8, 51, "Text",
 InitializationGroup->True],
Cell[24717, 714, 1147, 28, 77, "Input",
 InitializationGroup->True],
Cell[25867, 744, 924, 26, 77, "Input",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[26828, 775, 183, 3, 36, "Subsection",
 InitializationGroup->True],
Cell[27014, 780, 166, 2, 30, "Text",
 InitializationGroup->True],
Cell[27183, 784, 350, 7, 68, "Text",
 InitializationGroup->True],
Cell[27536, 793, 1011, 25, 46, "Input",
 InitializationGroup->True],
Cell[28550, 820, 1247, 31, 80, "Input",
 InitializationGroup->True],
Cell[29800, 853, 1940, 55, 182, "Input",
 InitializationGroup->True],
Cell[31743, 910, 330, 6, 68, "Text",
 InitializationGroup->True],
Cell[32076, 918, 4064, 101, 318, "Input",
 InitializationGroup->True],
Cell[36143, 1021, 256, 6, 49, "Text",
 InitializationGroup->True],
Cell[36402, 1029, 943, 26, 80, "Input",
 InitializationGroup->True],
Cell[37348, 1057, 152, 2, 30, "Text",
 InitializationGroup->True],
Cell[37503, 1061, 424, 11, 46, "Input",
 InitializationGroup->True],
Cell[37930, 1074, 129, 2, 30, "Text",
 InitializationGroup->True],
Cell[38062, 1078, 1142, 29, 114, "Input",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[39241, 1112, 158, 2, 36, "Subsection",
 InitializationGroup->True],
Cell[39402, 1116, 216, 5, 30, "Text",
 InitializationGroup->True],
Cell[39621, 1123, 1764, 46, 131, "Input",
 InitializationGroup->True],
Cell[41388, 1171, 100, 1, 30, "Text"],
Cell[41491, 1174, 681, 16, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[42209, 1195, 144, 2, 36, "Subsection",
 InitializationGroup->True],
Cell[42356, 1199, 461, 11, 51, "Text",
 InitializationGroup->True],
Cell[42820, 1212, 1293, 30, 55, "Input",
 InitializationGroup->True],
Cell[44116, 1244, 131, 2, 31, "Text",
 InitializationGroup->True],
Cell[44250, 1248, 960, 27, 55, "Input",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[45247, 1280, 207, 3, 36, "Subsection",
 InitializationGroup->True],
Cell[45457, 1285, 2048, 57, 97, "Input"],
Cell[47508, 1344, 234, 6, 28, "Input"],
Cell[47745, 1352, 226, 5, 28, "Input"],
Cell[47974, 1359, 145, 2, 30, "Text",
 InitializationGroup->True],
Cell[48122, 1363, 480, 14, 28, "Input",
 InitializationGroup->True],
Cell[48605, 1379, 585, 17, 28, "Input",
 InitializationGroup->True],
Cell[49193, 1398, 157, 2, 30, "Text",
 InitializationGroup->True],
Cell[49353, 1402, 884, 27, 46, "Input",
 InitializationGroup->True],
Cell[50240, 1431, 1925, 50, 148, "Input",
 InitializationGroup->True],
Cell[52168, 1483, 98, 1, 30, "Text"],
Cell[52269, 1486, 3163, 87, 148, "Input",
 InitializationGroup->True],
Cell[55435, 1575, 328, 10, 28, "Input"],
Cell[55766, 1587, 167, 2, 30, "Text"],
Cell[55936, 1591, 4559, 128, 284, "Input",
 InitializationGroup->True],
Cell[60498, 1721, 590, 12, 46, "Input"],
Cell[61091, 1735, 108, 1, 30, "Text"],
Cell[61202, 1738, 2212, 63, 97, "Input"],
Cell[63417, 1803, 283, 7, 28, "Input"],
Cell[63703, 1812, 2080, 60, 80, "Input"],
Cell[65786, 1874, 423, 10, 28, "Input"],
Cell[66212, 1886, 283, 7, 28, "Input"],
Cell[66498, 1895, 437, 10, 28, "Input"],
Cell[66938, 1907, 332, 8, 28, "Input"],
Cell[67273, 1917, 316, 8, 28, "Input"],
Cell[67592, 1927, 332, 8, 28, "Input"],
Cell[67927, 1937, 302, 7, 49, "Text",
 InitializationGroup->True],
Cell[68232, 1946, 2898, 80, 148, "Input",
 InitializationGroup->True],
Cell[71133, 2028, 699, 20, 80, "Input",
 InitializationGroup->True],
Cell[71835, 2050, 122, 2, 30, "Text",
 InitializationGroup->True],
Cell[71960, 2054, 324, 7, 28, "Input",
 InitializationGroup->True],
Cell[72287, 2063, 126, 2, 30, "Text",
 InitializationGroup->True],
Cell[72416, 2067, 2379, 63, 165, "Input",
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[74832, 2135, 152, 3, 44, "Subsection",
 InitializationGroup->True],
Cell[74987, 2140, 158, 2, 30, "Text",
 InitializationGroup->True],
Cell[75148, 2144, 6164, 160, 369, "Input",
 InitializationGroup->True],
Cell[81315, 2306, 2205, 60, 148, "Input",
 InitializationGroup->True],
Cell[83523, 2368, 2038, 65, 148, "Input"],
Cell[85564, 2435, 2210, 71, 148, "Input"],
Cell[87777, 2508, 1868, 56, 80, "Input"],
Cell[89648, 2566, 1895, 57, 97, "Input"],
Cell[91546, 2625, 461, 12, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[92044, 2642, 126, 3, 36, "Subsection"],
Cell[92173, 2647, 2330, 69, 167, "Input"],
Cell[94506, 2718, 654, 19, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[95197, 2742, 135, 1, 36, "Subsection"],
Cell[95335, 2745, 4195, 121, 233, "Input"],
Cell[99533, 2868, 501, 15, 28, "Input"],
Cell[100037, 2885, 1227, 35, 80, "Input"],
Cell[101267, 2922, 724, 19, 63, "Input"],
Cell[101994, 2943, 92, 1, 28, "Input"],
Cell[102089, 2946, 1686, 46, 114, "Input"],
Cell[103778, 2994, 1440, 41, 97, "Input"],
Cell[105221, 3037, 542, 14, 46, "Input"],
Cell[105766, 3053, 1138, 32, 65, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[106941, 3090, 107, 1, 36, "Subsection"],
Cell[107051, 3093, 403, 11, 31, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[107457, 3106, 3094, 88, 148, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[110554, 3196, 174, 3, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[110731, 3201, 639, 19, 63, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[111373, 3222, 270, 9, 31, "Text"],
Cell[111646, 3233, 989, 28, 46, "Input",
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[112672, 3266, 137, 2, 36, "Subsection"],
Cell[112812, 3270, 309, 9, 31, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[113124, 3281, 1014, 29, 80, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[114141, 3312, 1898, 55, 114, "Input"],
Cell[116042, 3369, 309, 9, 31, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[116354, 3380, 1014, 29, 80, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[117371, 3411, 169, 4, 31, "Text"],
Cell[117543, 3417, 2220, 63, 131, "Input"],
Cell[119766, 3482, 161, 3, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[119930, 3487, 407, 12, 30, "Input",
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[120374, 3504, 114, 1, 36, "Subsection"],
Cell[120491, 3507, 223, 5, 49, "Text",
 InitializationGroup->True],
Cell[120717, 3514, 1769, 53, 114, "Input",
 InitializationGroup->True],
Cell[122489, 3569, 246, 6, 50, "Text",
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[122772, 3580, 214, 3, 36, "Subsection"],
Cell[122989, 3585, 129, 1, 30, "Text"],
Cell[123121, 3588, 657, 19, 28, "Input"],
Cell[123781, 3609, 706, 20, 28, "Input"],
Cell[124490, 3631, 884, 25, 46, "Input"],
Cell[125377, 3658, 832, 24, 46, "Input"]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
